name: OpenTofu Tests
on:
  workflow_dispatch:
  pull_request:
  push:
    paths:
      - '**.tf'
      - '**.tfvars'
      - '.github/workflows/test.yml'
      
# Ensures that only one deploy task run at a time.
concurrency:
  group: tofu

permissions:
  # required for all workflows
  contents: write
  checks: write
  pull-requests: write
  discussions: write
  statuses: write
  id-token: write # This is required for requesting the JWT for oidc AUthentication

jobs:
  base:
    name: Base Test
    uses: otc-code/code-workflows/.github/workflows/tofu_test_aws.yml@main
    secrets: inherit
